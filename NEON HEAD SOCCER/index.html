<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Head Soccer</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap');

        body {
            margin: 0;
            background-color: #111;
            color: white;
            font-family: 'Black Ops One', cursive;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        #gameContainer {
            position: relative;
            box-shadow: 0 0 40px rgba(0, 255, 0, 0.2);
            border: 4px solid #333;
            width: 800px;
            height: 500px;
            background: #000;
        }

        canvas { display: block; }

        #scoreboard {
            position: absolute;
            top: 20px;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 100px;
            font-size: 60px;
            pointer-events: none;
            z-index: 10;
        }

        .score-p1 { color: #00ffff; text-shadow: 0 0 20px #00ffff; }
        .score-p2 { color: #ff0055; text-shadow: 0 0 20px #ff0055; }

        #overlay {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }
        
        button {
            padding: 15px 40px;
            font-size: 24px;
            font-family: 'Black Ops One', cursive;
            background: gold;
            border: none;
            cursor: pointer;
            text-transform: uppercase;
            margin-top: 20px;
            box-shadow: 0 0 15px gold;
        }
        button:hover { transform: scale(1.1); background: white; }

        .controls { color: #aaa; margin-top: 30px; font-family: sans-serif; font-size: 14px; }
        .key { border: 1px solid #777; padding: 2px 6px; border-radius: 4px; display: inline-block; }

    </style>
</head>
<body>

<div id="gameContainer">
    <div id="scoreboard">
        <div id="scoreP1" class="score-p1">0</div>
        <div id="scoreP2" class="score-p2">0</div>
    </div>

    <canvas id="gameCanvas" width="800" height="500"></canvas>

    <div id="overlay">
        <h1 style="font-size:60px; margin:0; color:white; text-shadow: 0 0 10px white;">NEON SOCCER</h1>
        <p style="color:gold;">‡πÉ‡∏Ñ‡∏£‡πÑ‡∏î‡πâ 5 ‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡∏Å‡πà‡∏≠‡∏ô‡∏ä‡∏ô‡∏∞!</p>
        <button onclick="startGame()">KICK OFF</button>
        
        <div style="display:flex; gap:50px;">
            <div class="controls" style="color:#00ffff">
                <h3>PLAYER 1 (BLUE)</h3>
                <p>‡πÄ‡∏î‡∏¥‡∏ô: <span class="key">A</span> <span class="key">D</span></p>
                <p>‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î: <span class="key">W</span></p>
            </div>
            <div class="controls" style="color:#ff0055">
                <h3>PLAYER 2 (RED)</h3>
                <p>‡πÄ‡∏î‡∏¥‡∏ô: <span class="key">ü°†</span> <span class="key">ü°¢</span></p>
                <p>‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î: <span class="key">ü°°</span></p>
            </div>
        </div>
        <h2 id="winnerText" style="display:none; margin-top:20px; font-size:40px;"></h2>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // --- Physics Config ---
    const GRAVITY = 0.5;
    const FRICTION = 0.96; // ‡πÅ‡∏£‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏ô‡∏û‡∏∑‡πâ‡∏ô
    const BOUNCE = 0.7; // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡πâ‡∏á‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•

    // --- Game State ---
    let gameState = 'MENU';
    let p1Score = 0;
    let p2Score = 0;
    let particles = [];
    let goalFlashTimer = 0;
    
    // Players (Circular Heads)
    const p1 = { x: 100, y: 400, r: 30, vx: 0, vy: 0, color: '#00ffff', speed: 1, jump: -12 };
    const p2 = { x: 700, y: 400, r: 30, vx: 0, vy: 0, color: '#ff0055', speed: 1, jump: -12 };
    
    // Ball
    const ball = { x: 400, y: 200, r: 20, vx: 0, vy: 0, color: '#ffffff' };
    
    // Goals
    const goalHeight = 180;
    const goalWidth = 60;

    const keys = {};

    function resetPositions() {
        p1.x = 100; p1.y = 400; p1.vx = 0; p1.vy = 0;
        p2.x = 700; p2.y = 400; p2.vx = 0; p2.vy = 0;
        ball.x = 400; ball.y = 100; ball.vx = 0; ball.vy = 0;
    }

    function startGame() {
        if(document.getElementById('winnerText').style.display !== 'none') {
            p1Score = 0; p2Score = 0;
            document.getElementById('scoreP1').innerText = 0;
            document.getElementById('scoreP2').innerText = 0;
        }
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('winnerText').style.display = 'none';
        gameState = 'PLAY';
        resetPositions();
        playSound('whistle');
        loop();
    }

    // --- Physics Engine ---
    function updatePhysics(obj, isBall = false) {
        // Gravity
        obj.vy += GRAVITY;
        obj.x += obj.vx;
        obj.y += obj.vy;

        // Friction (Only on floor)
        if (obj.y + obj.r >= canvas.height) {
            obj.vx *= FRICTION;
        }

        // Floor Collision
        if (obj.y + obj.r > canvas.height) {
            obj.y = canvas.height - obj.r;
            obj.vy *= isBall ? -BOUNCE : 0; // Ball bounces, player stops
        }
        // Ceiling
        if (obj.y - obj.r < 0) {
            obj.y = obj.r;
            obj.vy *= -0.5;
        }

        // Wall Collision
        if (obj.x - obj.r < 0) {
            obj.x = obj.r;
            obj.vx *= isBall ? -BOUNCE : 0;
        }
        if (obj.x + obj.r > canvas.width) {
            obj.x = canvas.width - obj.r;
            obj.vx *= isBall ? -BOUNCE : 0;
        }
    }

    function checkCollision(player, ball) {
        let dx = ball.x - player.x;
        let dy = ball.y - player.y;
        let dist = Math.sqrt(dx*dx + dy*dy);
        let minDist = player.r + ball.r;

        if (dist < minDist) {
            // Collision Detected: Push ball away
            let angle = Math.atan2(dy, dx);
            let force = 12; // ‡πÅ‡∏£‡∏á‡∏ú‡∏•‡∏±‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏°‡πà‡∏á
            
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡∏±‡∏ö
            let overlap = minDist - dist;
            let moveX = Math.cos(angle) * overlap;
            let moveY = Math.sin(angle) * overlap;
            ball.x += moveX;
            ball.y += moveY;

            // ‡∏™‡πà‡∏á‡πÅ‡∏£‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏• (Physics Response)
            ball.vx += Math.cos(angle) * force + player.vx * 0.5; // ‡∏ö‡∏ß‡∏Å‡πÅ‡∏£‡∏á‡∏ß‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢
            ball.vy += Math.sin(angle) * force + player.vy * 0.5;
            
            playSound('kick');
            createParticles(ball.x, ball.y, '#fff', 5);
        }
    }

    function checkGoal() {
        // Goal Areas: Left (0 to goalWidth), Right (width-goalWidth to width)
        // Check Y limit (goal height)
        
        // P2 Scored (Ball in Left Goal)
        if (ball.x - ball.r < goalWidth && ball.y > canvas.height - goalHeight) {
            handleGoal(2);
        }
        // P1 Scored (Ball in Right Goal)
        else if (ball.x + ball.r > canvas.width - goalWidth && ball.y > canvas.height - goalHeight) {
            handleGoal(1);
        }
    }

    function handleGoal(scorer) {
        playSound('goal');
        goalFlashTimer = 30; // Flash screen
        createParticles(ball.x, ball.y, scorer === 1 ? '#00ffff' : '#ff0055', 50);

        if (scorer === 1) {
            p1Score++;
            document.getElementById('scoreP1').innerText = p1Score;
        } else {
            p2Score++;
            document.getElementById('scoreP2').innerText = p2Score;
        }

        if (p1Score >= 5 || p2Score >= 5) {
            endGame(scorer === 1 ? "PLAYER 1 WINS!" : "PLAYER 2 WINS!");
        } else {
            resetPositions();
            // Ball starts at center, slightly up
        }
    }

    function endGame(msg) {
        gameState = 'END';
        document.getElementById('winnerText').innerText = msg;
        document.getElementById('winnerText').style.display = 'block';
        document.getElementById('winnerText').style.color = msg.includes("1") ? "#00ffff" : "#ff0055";
        document.getElementById('overlay').style.display = 'flex';
        playSound('win');
    }

    // --- Input Logic ---
    function handleInput() {
        // P1
        if (keys['a']) p1.vx -= p1.speed;
        if (keys['d']) p1.vx += p1.speed;
        if (keys['w'] && p1.y + p1.r >= canvas.height) { p1.vy = p1.jump; playSound('jump'); } // Jump only if on ground

        // P2
        if (keys['ArrowLeft']) p2.vx -= p2.speed;
        if (keys['ArrowRight']) p2.vx += p2.speed;
        if (keys['ArrowUp'] && p2.y + p2.r >= canvas.height) { p2.vy = p2.jump; playSound('jump'); }
        
        // Cap speed
        p1.vx = Math.max(-5, Math.min(5, p1.vx));
        p2.vx = Math.max(-5, Math.min(5, p2.vx));
    }

    // --- Render ---
    function draw() {
        // Clear
        ctx.fillStyle = '#000';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Flash Effect
        if (goalFlashTimer > 0) {
            ctx.fillStyle = `rgba(255, 255, 255, ${goalFlashTimer/30})`;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            goalFlashTimer--;
        }

        // Draw Field Lines
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(canvas.width/2, 0); ctx.lineTo(canvas.width/2, canvas.height); // Center
        ctx.stroke();
        ctx.beginPath();
        ctx.arc(canvas.width/2, canvas.height/2, 100, 0, Math.PI*2); // Center Circle
        ctx.stroke();

        // Draw Goals
        ctx.fillStyle = 'rgba(0, 255, 255, 0.2)'; // P1 Goal Area
        ctx.fillRect(0, canvas.height - goalHeight, goalWidth, goalHeight);
        ctx.fillStyle = 'rgba(255, 0, 85, 0.2)'; // P2 Goal Area
        ctx.fillRect(canvas.width - goalWidth, canvas.height - goalHeight, goalWidth, goalHeight);

        // Draw Players
        drawCircle(p1.x, p1.y, p1.r, p1.color);
        drawCircle(p2.x, p2.y, p2.r, p2.color);
        
        // Draw Eye (to see direction/face)
        ctx.fillStyle = 'white';
        // P1 Eye (Look Right)
        ctx.beginPath(); ctx.arc(p1.x + 10, p1.y - 5, 8, 0, Math.PI*2); ctx.fill();
        // P2 Eye (Look Left)
        ctx.beginPath(); ctx.arc(p2.x - 10, p2.y - 5, 8, 0, Math.PI*2); ctx.fill();

        // Draw Ball
        drawCircle(ball.x, ball.y, ball.r, '#fff');
        // Ball Pattern
        ctx.fillStyle = '#000';
        ctx.beginPath(); ctx.arc(ball.x, ball.y, 10, 0, Math.PI*2); ctx.fill();

        // Particles
        for(let i=particles.length-1; i>=0; i--) {
            let p = particles[i];
            p.x += p.vx; p.y += p.vy; p.life--;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, p.size, p.size);
            if(p.life <= 0) particles.splice(i, 1);
        }
    }

    function drawCircle(x, y, r, color) {
        ctx.fillStyle = color;
        ctx.shadowBlur = 15; ctx.shadowColor = color;
        ctx.beginPath();
        ctx.arc(x, y, r, 0, Math.PI*2);
        ctx.fill();
        ctx.shadowBlur = 0;
    }

    // --- Main Loop ---
    function loop() {
        if(gameState !== 'PLAY') return;

        handleInput();
        updatePhysics(p1);
        updatePhysics(p2);
        updatePhysics(ball, true);

        checkCollision(p1, ball);
        checkCollision(p2, ball);
        checkGoal();

        draw();
        requestAnimationFrame(loop);
    }

    // --- Helpers ---
    function createParticles(x, y, color, count) {
        for(let i=0; i<count; i++) {
            particles.push({
                x: x, y: y,
                vx: (Math.random()-0.5)*10, vy: (Math.random()-0.5)*10,
                life: 30, size: Math.random()*5+2, color: color
            });
        }
    }

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        osc.connect(g); g.connect(audioCtx.destination);
        const now = audioCtx.currentTime;

        if (type === 'kick') {
            osc.frequency.setValueAtTime(150, now); osc.frequency.exponentialRampToValueAtTime(50, now+0.1);
            g.gain.setValueAtTime(0.2, now); g.gain.linearRampToValueAtTime(0, now+0.1);
            osc.start(now); osc.stop(now+0.1);
        } else if (type === 'jump') {
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(200, now); osc.frequency.linearRampToValueAtTime(300, now+0.1);
            g.gain.setValueAtTime(0.1, now); g.gain.linearRampToValueAtTime(0, now+0.1);
            osc.start(now); osc.stop(now+0.1);
        } else if (type === 'goal') {
            osc.type = 'square';
            osc.frequency.setValueAtTime(400, now); osc.frequency.linearRampToValueAtTime(800, now+0.5);
            g.gain.setValueAtTime(0.2, now); g.gain.linearRampToValueAtTime(0, now+0.5);
            osc.start(now); osc.stop(now+0.5);
        } else if (type === 'whistle') {
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(2000, now); 
            g.gain.setValueAtTime(0.1, now); g.gain.linearRampToValueAtTime(0, now+0.5);
            osc.start(now); osc.stop(now+0.5);
        } else if (type === 'win') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(400, now); osc.frequency.linearRampToValueAtTime(600, now+1);
            g.gain.setValueAtTime(0.2, now); g.gain.linearRampToValueAtTime(0, now+1);
            osc.start(now); osc.stop(now+1);
        }
    }

    window.addEventListener('keydown', e => keys[e.key] = true);
    window.addEventListener('keyup', e => keys[e.key] = false);

</script>

</body>
</html>